<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#0a1022; --bg2:#190f2c;
      --card:#ffffff12; --stroke:#ffffff26;
      --text:#f7f7ff; --muted:#cfd3ff;
      --pink:#ff4fb0; --violet:#7c5cff; --mint:#46e6a3;
      --shadow: 0 22px 70px rgba(0,0,0,.45);
      --r: 24px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Prompt",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 15% 10%, rgba(255,79,176,.20), transparent 60%),
        radial-gradient(1000px 700px at 85% 20%, rgba(124,92,255,.18), transparent 60%),
        radial-gradient(900px 700px at 50% 100%, rgba(70,230,163,.10), transparent 60%),
        linear-gradient(140deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    /* subtle noise */
    .noise{
      position:fixed; inset:0; pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      opacity:.16; mix-blend-mode:overlay;
    }

    /* floating hearts layer */
    .hearts{ position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:0; }
    .heart{
      position:absolute; font-size:16px; opacity:.9;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.35));
      animation: floatUp linear forwards; user-select:none;
    }
    @keyframes floatUp{
      from{ transform: translateY(20px) scale(.9); opacity:0; }
      15%{ opacity:.95; }
      to{ transform: translateY(-120vh) scale(1.25) rotate(12deg); opacity:0; }
    }

    .wrap{ min-height:100%; display:grid; place-items:center; padding:20px; }
    .card{
      width:min(660px, 100%);
      background:linear-gradient(180deg, rgba(255,255,255,.11), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:22px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      position:relative; overflow:hidden; z-index:1;
    }
    .glow{
      position:absolute; inset:-80px; pointer-events:none;
      background:
        radial-gradient(500px 240px at 10% 10%, rgba(255,79,176,.25), transparent 60%),
        radial-gradient(520px 260px at 90% 0%, rgba(124,92,255,.22), transparent 62%),
        radial-gradient(520px 280px at 50% 110%, rgba(70,230,163,.14), transparent 62%);
      filter: blur(20px);
      opacity:.9;
    }

    .top{ display:flex; align-items:center; justify-content:space-between; gap:10px; position:relative; z-index:1; }
    .badge{
      display:inline-flex; align-items:center; gap:10px;
      padding:8px 12px; border-radius:999px;
      border:1px solid rgba(255,255,255,.20);
      background:rgba(255,255,255,.08);
      font-size:13px; color:rgba(207,211,255,.9);
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
    }
    .dot{
      width:9px;height:9px;border-radius:50%;
      background:linear-gradient(135deg, var(--pink), var(--violet));
      box-shadow:0 0 0 6px rgba(255,79,176,.12);
    }
    .chip{
      font-size:12px; color:rgba(207,211,255,.85);
      padding:7px 10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.14);
      white-space:nowrap;
    }

    h1{ margin:14px 0 6px; font-size:30px; line-height:1.2; letter-spacing:.2px; position:relative; z-index:1; }
    p{ margin:0 0 14px; color:rgba(207,211,255,.88); line-height:1.7; position:relative; z-index:1; }

    .typebox{
      margin-top:12px; border-radius:18px; padding:14px 14px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      position:relative; z-index:1;
    }
    .type{
      display:inline;
      border-right:2px solid rgba(255,255,255,.6);
      padding-right:4px;
      animation: caret .9s step-end infinite;
    }
    @keyframes caret{ 50%{border-color:transparent} }

    .meter{ margin-top:12px; display:flex; align-items:center; gap:10px; position:relative; z-index:1; }
    .meter label{ font-size:12.5px; color:rgba(207,211,255,.88); white-space:nowrap; }
    .bar{
      flex:1; height:12px; border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.12);
      overflow:hidden; position:relative;
    }
    .fill{
      height:100%; width:35%; border-radius:999px;
      background:linear-gradient(90deg, rgba(255,79,176,.85), rgba(124,92,255,.85), rgba(70,230,163,.75));
      transition: width .35s ease;
    }
    .pulse{
      position:absolute; inset:0; pointer-events:none;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
      transform: translateX(-100%);
      animation: sheen 1.6s ease infinite;
    }
    @keyframes sheen{ to{ transform: translateX(100%);} }

    .arena{
      margin-top:16px; position:relative; height:150px;
      border-radius:18px;
      border:1px dashed rgba(255,255,255,.22);
      background:rgba(0,0,0,.12);
      overflow:hidden;
      z-index:1;
    }

    .btn{
      user-select:none; -webkit-tap-highlight-color:transparent;
      appearance:none;
      border:1px solid rgba(255,255,255,.22);
      background:rgba(255,255,255,.10);
      color:var(--text);
      padding:12px 16px;
      border-radius:18px;
      font-weight:900;
      cursor:pointer;
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
      position:absolute;
      display:inline-flex; align-items:center; gap:10px;
      touch-action:none;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }

    .btn-yes{
      left:14px; top:14px;
      background:linear-gradient(135deg, rgba(255,79,176,.40), rgba(124,92,255,.30));
      border-color: rgba(255,255,255,.28);
    }
    .btn-yes:hover{ background:linear-gradient(135deg, rgba(255,79,176,.52), rgba(124,92,255,.38)); }

    .btn-no{
      right:14px; bottom:14px;
      background:rgba(255,255,255,.08);
    }

    /* ‡∏Å‡∏ß‡∏ô‡πÜ: ‡∏™‡∏±‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡∏´‡∏ô‡∏µ */
    .btn-no.wiggle{ animation: wiggle .28s ease; }
    @keyframes wiggle{
      0%{ transform: translate(0,0) rotate(0deg); }
      30%{ transform: translate(-2px,1px) rotate(-2deg); }
      60%{ transform: translate(2px,-1px) rotate(2deg); }
      100%{ transform: translate(0,0) rotate(0deg); }
    }

    /* tooltip ‡∏Å‡∏ß‡∏ô‡πÜ */
    .no-tip{
      position:absolute;
      padding:8px 10px;
      font-size:12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.22);
      background:rgba(0,0,0,.28);
      color:rgba(245,245,255,.92);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      pointer-events:none;
      opacity:0;
      transform: translateY(6px);
      transition: .18s ease;
      white-space: nowrap;
      z-index:5;
    }
    .no-tip.show{ opacity:1; transform: translateY(0); }

    .miniRow{ margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; position:relative; z-index:1; }
    .ghost{
      flex:1;
      padding:11px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      color:rgba(245,245,255,.92);
      font-weight:900;
      cursor:pointer;
    }
    .ghost:hover{ background:rgba(255,255,255,.09); }

    .hint{ margin-top:10px; font-size:12.5px; color:rgba(207,211,255,.75); position:relative; z-index:1; }
    .footer{
      margin-top:12px; display:flex; justify-content:space-between; gap:10px;
      color:rgba(207,211,255,.72); font-size:12px;
      position:relative; z-index:1;
    }

    /* modal */
    .overlay{
      position:fixed; inset:0; display:none; place-items:center;
      background:rgba(0,0,0,.55); padding:18px; z-index:10;
    }
    .overlay.show{ display:grid; }

    .modal{
      width:min(620px, 100%);
      background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.08));
      border:1px solid rgba(255,255,255,.22);
      border-radius:22px;
      box-shadow: var(--shadow);
      padding:18px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      position:relative; overflow:hidden;
    }

    .modal h2{ margin:6px 0 6px; font-size:24px; }
    .modal p{ margin:0 0 12px; color:rgba(207,211,255,.88); }

    /* ===== GIF Slot (Local file) ===== */
    .gif-slot{
      margin: 10px 0 12px;
      display:flex;
      justify-content:center;
      align-items:center;
    }
    .gif-img{
      width: min(240px, 70vw);
      height: auto;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      box-shadow: 0 14px 28px rgba(0,0,0,.35);
    }
    .gif-placeholder{
      width: min(360px, 90vw);
      padding: 14px 12px;
      text-align:center;
      border-radius: 18px;
      border: 1px dashed rgba(255,255,255,.24);
      background: rgba(255,255,255,.06);
      color: rgba(207,211,255,.9);
      font-size: 13px;
      line-height: 1.55;
    }

    .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .pill{
      padding:10px 12px; border-radius:14px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      font-size:13px; color:rgba(207,211,255,.9);
      flex:1; min-width:200px;
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
    }

    .close{
      margin-top:10px; width:100%;
      padding:12px 14px; border-radius:16px;
      border:1px solid rgba(255,255,255,.22);
      background:rgba(255,255,255,.10);
      color:var(--text); font-weight:950; cursor:pointer;
    }

    /* confetti */
    .confetti{ position:absolute; inset:0; pointer-events:none; overflow:hidden; opacity:.95; }
    .piece{
      position:absolute; top:-14px; width:10px; height:16px; border-radius:3px;
      transform: rotate(12deg);
      animation: fall 1.25s linear forwards;
    }
    @keyframes fall{ to{ transform: translateY(140%) rotate(260deg); opacity:1; } }

    @media (max-width:420px){
      h1{font-size:26px}
      .arena{ height:165px; }
    }
  </style>
</head>

<body>
  <div class="noise" aria-hidden="true"></div>
  <div class="hearts" id="hearts" aria-hidden="true"></div>

  <main class="wrap">
    <section class="card" aria-label="Love proposal card">
      <div class="glow" aria-hidden="true"></div>

      <div class="top">
        <div class="badge"><span class="dot"></span> ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏Å‡∏≤‡∏ô‡∏ô‡∏ô</div>
        <div class="chip" id="clock">‚Äî</div>
      </div>

      <h1>‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏Å‡∏±‡∏ö‡∏û‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°</h1>
      <p>‡∏û‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏û‡∏µ‡πà‡∏ô‡∏∞‚Ä¶ ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏µ‡πà‡∏Å‡πá‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ò‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡πÜ</p>

      <div class="typebox" role="status" aria-live="polite">
        <span class="type" id="type"></span>
      </div>

      <div class="meter" aria-label="love meter">
        <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô</label>
        <div class="bar">
          <div class="fill" id="fill"></div>
          <div class="pulse" aria-hidden="true"></div>
        </div>
        <div class="chip" id="pct">35%</div>
      </div>

      <div class="arena" id="arena" aria-label="buttons area">
        <button class="btn btn-yes" id="yesBtn" type="button" aria-label="‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô">üíó ‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô</button>
        <button class="btn btn-no" id="noBtn" type="button" aria-label="‡πÑ‡∏°‡πà‡∏ï‡∏Å‡∏•‡∏á">üôÖ‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡πà‡∏ï‡∏Å‡∏•‡∏á</button>
      </div>

      <div class="miniRow">
        <button class="ghost" id="copyBtn" type="button">Love youuuu</button>
        <button class="ghost" id="burstBtn" type="button">‡∏¢‡∏¥‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏£‡∏±‡∏ß ‡πÜ</button>
      </div>

      <div class="hint"></div>
      <div class="footer">
        <div>‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡πÄ‡∏ü‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞‡∏ô‡∏∞‡∏∞</div>
        <div id="netHint"></div>
      </div>
    </section>
  </main>

  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-label="success dialog">
    <div class="modal">
      <div class="confetti" id="confetti" aria-hidden="true"></div>

      <div class="badge"><span class="dot"></span> ‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</div>
      <h2>‡πÄ‡∏¢‡πâ! ‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</h2>
      <p id="status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏û‡∏µ‡πà‚Ä¶</p>

      <!-- ====== GIF Slot (‡∏ß‡∏¥‡∏ò‡∏µ A: ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á) ====== -->
      <!-- ‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ä‡∏∑‡πà‡∏≠ sticker.gif ‡πÑ‡∏ß‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö index.html -->
      <div class="gif-slot" id="gifSlot" aria-label="sticker gif slot">
        <img id="gifImg" class="gif-img" src="sticker.gif" alt="sticker gif" />
      </div>

      <div class="row">
        <div class="pill" id="meta1"></div>
        <div class="pill" id="meta2"></div>
      </div>

      <button class="close" id="closeBtn" type="button">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>

  <script>
    // =======================
    // CONFIG
    // =======================
    const TO_EMAIL = "Apiwut.kw@gmail.com";
    // ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ú‡πà‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (AJAX endpoint)
    const FORMSUBMIT_AJAX_ENDPOINT = `https://formsubmit.co/ajax/${encodeURIComponent(TO_EMAIL)}`;

    // =======================
    // Typewriter
    // =======================
    const typeEl = document.getElementById("type");
    const lines = [
      "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞‡∏∞",
      "‡∏û‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á ‡πÜ ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠",
      "‡πÑ‡∏°‡πà‡πÄ‡∏£‡πà‡∏á‡∏ô‡∏∞ ‡πÅ‡∏ï‡πà‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢‚Ä¶",
      "‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏Å‡∏±‡∏ö‡∏û‡∏µ‡πà‡∏ô‡∏∞ :)"
    ];
    let li = 0, ci = 0;
    function typeLoop(){
      const t = lines[li];
      typeEl.textContent = t.slice(0, ci++);
      if (ci <= t.length) requestAnimationFrame(typeLoop);
      else {
        setTimeout(() => {
          li = (li + 1) % lines.length;
          ci = 0;
          setTimeout(typeLoop, 450);
        }, 900);
      }
    }
    typeLoop();

    // =======================
    // Clock
    // =======================
    const clock = document.getElementById("clock");
    function tick(){
      const d = new Date();
      clock.textContent = new Intl.DateTimeFormat("th-TH",{dateStyle:"medium",timeStyle:"short"}).format(d);
    }
    tick(); setInterval(tick, 1000);

    // =======================
    // Floating hearts
    // =======================
    const hearts = document.getElementById("hearts");
    const heartEmojis = ["üíó","üíñ","üíò","üíû","üíì","üíï","‚ú®","üå∑","üçì"];
    function spawnHeart(burst=false){
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = heartEmojis[Math.floor(Math.random()*heartEmojis.length)];
      h.style.left = (Math.random()*100) + "vw";
      h.style.bottom = (-10 + Math.random()*10) + "px";
      const dur = burst ? (3.2 + Math.random()*1.6) : (5.0 + Math.random()*3.0);
      h.style.animationDuration = dur + "s";
      h.style.fontSize = (14 + Math.random()*14) + "px";
      hearts.appendChild(h);
      setTimeout(()=>h.remove(), (dur*1000)+120);
    }
    setInterval(()=>spawnHeart(false), 700);
    document.getElementById("burstBtn").addEventListener("click", ()=>{
      for(let i=0;i<12;i++) setTimeout(()=>spawnHeart(true), i*35);
    });

    // =======================
    // Love meter
    // =======================
    const fill = document.getElementById("fill");
    const pct = document.getElementById("pct");
    let love = 35;
    function setLove(v){
      love = Math.max(0, Math.min(100, v));
      fill.style.width = love + "%";
      pct.textContent = love + "%";
    }
    setLove(love);

    // =======================
    // No button (‡∏Å‡∏ß‡∏ô + ‡∏´‡∏•‡∏ö)
    // =======================
    const arena = document.getElementById("arena");
    const noBtn = document.getElementById("noBtn");

    const NO_TEXTS = [
      "üôÖ‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡πà‡∏ï‡∏Å‡∏•‡∏á", "‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏≠ üòè", "‡∏Å‡∏î‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏´‡∏£‡∏≠‡∏Å~", "‡πÄ‡∏≠‡πä‡∏∞ ‡∏°‡∏∑‡∏≠‡∏™‡∏±‡πà‡∏ô‡∏õ‡∏∞",
      "‡∏Ñ‡∏¥‡∏î‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ü§≠", "‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ üòú", "‡∏Æ‡∏±‡πà‡∏ô‡πÅ‡∏ô‡πà ‡∏à‡∏∞‡∏Å‡∏î‡πÉ‡∏ä‡πà‡∏°‡∏±‡πâ‡∏¢",
      "‡∏´‡∏¢‡∏≠‡∏Å‡πÜ ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏´‡∏£‡∏≠‡∏Å", "‡∏à‡∏∞‡∏´‡∏ô‡∏µ‡∏ó‡∏≥‡πÑ‡∏° üòå", "‡∏ä‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏¥‡∏î~"
    ];
    function randomNoText(){
      noBtn.textContent = NO_TEXTS[Math.floor(Math.random() * NO_TEXTS.length)];
    }

    const tip = document.createElement("div");
    tip.className = "no-tip";
    tip.textContent = "‡∏Å‡∏î‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏´‡∏£‡∏≠‡∏Å~ üòù";
    arena.appendChild(tip);

    let tipTimer = null;
    function showTipNearButton(msg){
      tip.textContent = msg || "‡∏Å‡∏î‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏´‡∏£‡∏≠‡∏Å~ üòù";
      const a = arena.getBoundingClientRect();
      const b = noBtn.getBoundingClientRect();

      const left = (b.left - a.left) + (b.width/2) - 70;
      const top  = (b.top - a.top) - 42;

      tip.style.left = `${Math.max(10, Math.min(a.width - 160, left))}px`;
      tip.style.top  = `${Math.max(10, top)}px`;

      tip.classList.add("show");
      clearTimeout(tipTimer);
      tipTimer = setTimeout(()=> tip.classList.remove("show"), 650);
    }

    function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

    function afterNoEscapes(){
      randomNoText();
      noBtn.classList.remove("wiggle");
      void noBtn.offsetWidth; // retrigger
      noBtn.classList.add("wiggle");

      const tipMsgs = ["‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏≠‡πà‡∏∞ üòú", "‡∏Æ‡∏±‡πà‡∏ô‡πÅ‡∏ô‡πà!", "‡∏ä‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏¥‡∏î~", "‡πÄ‡∏≠‡πã? ‡∏à‡∏∞‡∏Å‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏î‡∏¥", "‡∏ß‡πâ‡∏≤‡∏¢ ‡∏´‡∏•‡∏ö‡πÑ‡∏î‡πâ~"];
      showTipNearButton(tipMsgs[Math.floor(Math.random()*tipMsgs.length)]);

      setLove(Math.min(100, love + 3));
      spawnHeart(true);
    }

    function moveNoButton(px, py){
      const a = arena.getBoundingClientRect();
      const b = noBtn.getBoundingClientRect();

      const pad = 10;
      const minX = pad, minY = pad;
      const maxX = a.width - b.width - pad;
      const maxY = a.height - b.height - pad;

      const pointerX = clamp(px - a.left, 0, a.width);
      const pointerY = clamp(py - a.top, 0, a.height);

      let best = {x: Math.random()*maxX, y: Math.random()*maxY, score:-1};
      for(let i=0;i<16;i++){
        const x = minX + Math.random()*(maxX - minX);
        const y = minY + Math.random()*(maxY - minY);
        const dx = (x + b.width/2) - pointerX;
        const dy = (y + b.height/2) - pointerY;
        const dist = Math.sqrt(dx*dx + dy*dy);
        if(dist > best.score) best = {x,y,score:dist};
      }

      noBtn.style.left = best.x + "px";
      noBtn.style.top  = best.y + "px";
      noBtn.style.right = "auto";
      noBtn.style.bottom = "auto";

      afterNoEscapes();
    }

    function evade(e){
      const p = (e.touches && e.touches[0]) ? e.touches[0] : e;
      moveNoButton(p.clientX, p.clientY);
    }

    noBtn.addEventListener("pointerenter", (e)=>{ randomNoText(); showTipNearButton("‡∏à‡∏∞‡∏Å‡∏î‡∏´‡∏£‡∏≠ üòè"); evade(e); });
    noBtn.addEventListener("pointerdown", (e)=>{ randomNoText(); showTipNearButton("‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏´‡∏£‡∏≠‡∏Å~"); evade(e); });
    noBtn.addEventListener("touchstart", (e)=>{ randomNoText(); showTipNearButton("‡∏à‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ~ üòù"); evade(e); }, {passive:false});
    arena.addEventListener("pointermove", (e)=>{
      const nb = noBtn.getBoundingClientRect();
      const dx = (nb.left + nb.width/2) - e.clientX;
      const dy = (nb.top + nb.height/2) - e.clientY;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if(dist < 130) moveNoButton(e.clientX, e.clientY);
    });
    noBtn.addEventListener("click", (e)=>{ e.preventDefault(); showTipNearButton("‡∏ö‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡πà‡∏≤‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ üòú"); evade(e); });

    // =======================
    // Copy sweet text
    // =======================
    function timeTH(){
      return new Intl.DateTimeFormat("th-TH",{dateStyle:"full",timeStyle:"medium"}).format(new Date());
    }
    function buildEmailText(){
      return `‡∏£‡∏∏‡πà‡∏ô‡∏ô‡πâ‡∏≠‡∏á‡∏ï‡∏≠‡∏ö‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡πÅ‡∏•‡πâ‡∏ß üíó

‡πÄ‡∏ß‡∏•‡∏≤: ${timeTH()}

‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏û‡∏µ‡πà:
‡∏û‡∏µ‡πà‡∏î‡∏µ‡πÉ‡∏à‡∏°‡∏≤‡∏Å‡∏ô‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏µ‡πà ‡∏û‡∏µ‡πà‡∏à‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î`;
    }
    const copyBtn = document.getElementById("copyBtn");
    copyBtn.addEventListener("click", async ()=>{
      try{
        await navigator.clipboard.writeText(buildEmailText());
        copyBtn.textContent = "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß";
        setTimeout(()=>copyBtn.textContent="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô ‡πÜ", 1200);
      }catch{
        alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö");
      }
    });

    // =======================
    // Modal + confetti
    // =======================
    const overlay = document.getElementById("overlay");
    const statusEl = document.getElementById("status");
    const meta1 = document.getElementById("meta1");
    const meta2 = document.getElementById("meta2");
    const closeBtn = document.getElementById("closeBtn");
    const confetti = document.getElementById("confetti");
    const netHint = document.getElementById("netHint");

    function makeConfetti(){
      confetti.innerHTML = "";
      for(let i=0;i<28;i++){
        const el = document.createElement("div");
        el.className = "piece";
        el.style.left = (Math.random()*100) + "%";
        el.style.animationDelay = (Math.random()*0.25) + "s";
        const hue = Math.floor(Math.random()*360);
        el.style.background = `hsl(${hue} 90% 70%)`;
        confetti.appendChild(el);
      }
    }
    function openModal(){ overlay.classList.add("show"); makeConfetti(); }
    function closeModal(){ overlay.classList.remove("show"); }
    closeBtn.addEventListener("click", closeModal);
    overlay.addEventListener("click", (e)=>{ if(e.target === overlay) closeModal(); });

    // =======================
    // ‡∏Å‡∏±‡∏ô‡∏£‡∏π‡∏õ GIF ‡πÅ‡∏ï‡∏Å ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ sticker.gif
    // =======================
    const gifImg = document.getElementById("gifImg");
    if (gifImg) {
      gifImg.addEventListener("error", () => {
        gifImg.style.display = "none";
        const slot = document.getElementById("gifSlot");
        if (slot) {
          const ph = document.createElement("div");
          ph.className = "gif-placeholder";
          ph.innerHTML = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå <b>sticker.gif</b><br>‡πÉ‡∏´‡πâ‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏ß‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö <b>index.html</b>';
          slot.appendChild(ph);
        }
      });
    }

    // =======================
    // ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (AJAX)
    // =======================
    async function sendEmailAuto(){
      const payload = {
        subject: "‡πÄ‡∏ò‡∏≠‡∏ï‡∏≠‡∏ö‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡πÅ‡∏•‡πâ‡∏ß üíó",
        message: buildEmailText(),
        _captcha: "false",
        _next: window.location.href
      };

      const res = await fetch(FORMSUBMIT_AJAX_ENDPOINT, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Accept": "application/json"
        },
        body: JSON.stringify(payload)
      });

      if(!res.ok){
        const txt = await res.text().catch(()=> "");
        throw new Error(`HTTP ${res.status} ${txt}`);
      }
      return await res.json().catch(()=> ({}));
    }

    // =======================
    // YES button
    // =======================
    const yesBtn = document.getElementById("yesBtn");
    let sending = false;

    yesBtn.addEventListener("click", async ()=>{
      if(sending) return;
      sending = true;

      setLove(100);
      for(let i=0;i<16;i++) setTimeout(()=>spawnHeart(true), i*28);

      openModal();
      meta1.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤: " + timeTH();
      meta2.textContent = "‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á: " + TO_EMAIL;
      statusEl.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏û‡∏µ‡πà‚Ä¶";

      try{
        await sendEmailAuto();
        statusEl.textContent = "‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß üíó";
        netHint.textContent = "‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß";
      }catch(err){
        console.warn(err);
        statusEl.textContent =
          "‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡πÄ‡∏ô‡πá‡∏ï/‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å) ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö";
        netHint.textContent = "‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà";
      }finally{
        sending = false;
      }
    });

    // =======================
    // Keyboard accessibility
    // =======================
    yesBtn.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " "){
        e.preventDefault();
        yesBtn.click();
      }
    });
  </script>

  <!--
    ‡∏ß‡∏¥‡∏ò‡∏µ A (GIF ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á):
    1) ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ü‡∏•‡πå GIF ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ "sticker.gif"
    2) ‡∏ß‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö index.html
    3) ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà => GIF ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏°‡∏î‡∏≠‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
  -->
</body>
</html>